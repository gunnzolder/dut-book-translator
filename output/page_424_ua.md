#### 12.2.2.2 Ескіз Count-Min

Хоча блум-фільтр ефективний для запитів на членство в наборі, він не призначений для методів, які вимагають підсумків на основі підрахунку. Це тому, що блум-фільтр відстежує лише бінарні значення. Ескіз count-min призначений для вирішення таких запитів і інтуїтивно пов'язаний з блум-фільтром. Ескіз count-min складається з набору з $w$ різних числових масивів, кожен з яких має довжину $m$. Таким чином, вимога до простору для ескізу count-min дорівнює $m \cdot w$ комірок, що містять числові значення. Елементи кожного з $w$ числових масивів індексуються, починаючи з 0, що відповідає діапазону індексів $\{0...m - 1\}$. Ескіз count-min також можна розглядати як $w \times m$-вимірний масив комірок.

Кожен з $w$ числових масивів відповідає хеш-функції. $i$-й числовий масив відповідає $i$-й хеш-функції $h_i(\cdot)$. Хеш-функції мають такі властивості:

1. $i$-та хеш-функція $h_i(\cdot)$ відображає елемент потоку на ціле число в діапазоні $\{0 ... m - 1\}$. Це відображення також можна розглядати як одне із значень індексу в $i$-му числовому масиві.

2. $w$ хеш-функцій $h_1(\cdot) ... h_w(\cdot)$ є повністю незалежними одна від одної, але попарно незалежними для різних аргументів. Іншими словами, для будь-яких двох значень $x_1$ та $x_2$, $h_i(x_1)$ та $h_i(x_2)$ є незалежними.

Вимога попарної незалежності є слабшою, ніж вимога повної незалежності. Це зручна властивість ескізу count-min, оскільки зазвичай легше побудувати попарно незалежні хеш-функції, ніж повністю незалежні.

Процедура оновлення ескізу виглядає так. Всі $m \cdot w$ записи в ескізі count-min ініціалізуються нулями. Для кожного вхідного елемента потоку $x$ до нього застосовуються функції $h_1(x) ... h_w(x)$. Для $i$-го масиву елемент $h_i(x)$ збільшується на 1. Таким чином, якщо ескіз count-min $CM$ візуалізувати як 2-вимірний $w \times m$ числовий масив, то елемент $(i, h_i(x))$ збільшується^2 на 1. Зверніть увагу, що значення $h_i(x)$ відображається на ціле число в діапазоні $[0, m - 1]$. Це також діапазон індексів кожного числового масиву. Наочна ілюстрація ескізу count-min та відповідного процесу оновлення наведена на рис. 12.4. Псевдокод для загального процесу оновлення показано на рис. 12.5. У псевдокоді потік позначається як $S$, а структура даних ескізу count-min позначається як $CM$. Вхідними даними для алгоритму є потік $S$ та два параметри $(w, m)$, що визначають розмір 2-вимірного масиву для ескізу count-min. 2-вимірний масив $w \times m$ $CM$ ініціалізується з усіма значеннями, встановленими на 0. Для кожного вхідного елемента потоку підраховуються всі

^2 У випадку, коли кожен окремий елемент пов'язаний з невід'ємною частотою, ескіз count-min можна оновити значенням частоти. Тут розглядається лише простий випадок одиничних оновлень.
```

[Рисунок 12.4: Ескіз count-min, сторінка 403]

[назва ілюстрації, сторінка 403]