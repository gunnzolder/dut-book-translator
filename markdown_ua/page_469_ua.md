## 13.5.2.1 Модель мультиноміального Баєса

Більш загальним підходом є використання мультиноміальної моделі Баєса, в якій явно використовуються частоти слів. Модель Бернуллі корисна переважно для випадків, коли документи короткі та складаються з лексики невеликого розміру. У загальному випадку документів більшого розміру над великою лексикою мультиноміальна модель є більш ефективною. Перш ніж обговорювати мультиноміальну модель, модель Бернуллі (див. розділ 10.5.1 глави 10) буде розглянута в контексті класифікації тексту.

Нехай $C$ - випадкова змінна, що представляє змінну класу невидимого тестового екземпляра з $d$-вимірними значеннями ознак $X = (a_1, \ldots, a_d)$. Для моделі Бернуллі на текстових даних кожне значення $a_i$ дорівнює 1 або 0 залежно від того, чи присутнє $i$-те слово лексики в документі $X$. Метою є оцінка апостеріорної ймовірності $P(C = c|X = (a_1, \ldots, a_d))$. Нехай випадкові змінні для окремих вимірів $X$ позначаються як $X = (x_1, \ldots, x_d)$. Тоді потрібно оцінити умовну ймовірність $P(C = c|x_1 = a_1, \ldots, x_d = a_d)$. Тоді, використовуючи теорему Баєса, можна зробити такий висновок:

\[
P(C = c|x_1 = a_1, \ldots, x_d = a_d) = \frac{P(C = c)P(x_1 = a_1, \ldots, x_d = a_d|C = c)}{P(x_1 = a_1, \ldots, x_d = a_d)} \tag{13.17}
\]

\[
\propto P(C = c)P(x_1 = a_1, \ldots, x_d = a_d|C = c) \tag{13.18}
\]

\[
\approx P(C = c) \prod_{i=1}^{d} P(x_i = a_i|C = c). \tag{13.19}
\]

Останнє з вищезазначених співвідношень базується на наївному припущенні умовної незалежності. У бінарній моделі, обговореній у главі 10, кожне значення атрибута $a_i$ приймає значення 1 або 0 залежно від присутності або відсутності слова. Таким чином, якщо частка документів у класі $c$, що містять слово $i$, позначається як $p(i, c)$, то значення $P(x_i = a_i|C = c)$ оцінюється як $p(i, c)$ або $1 - p(i, c)$ залежно від того, чи $a_i$ дорівнює 1 або 0 відповідно. Зверніть увагу, що цей підхід явно карає невиникнення слів у документах. Більші розміри лексики призведуть до того, що багато слів будуть відсутні в документі. Тому модель Бернуллі може домінувати відсутність слова, а не