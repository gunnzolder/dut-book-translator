Визначення 12.4.1 Мікрокластер для набору $d$-вимірних точок $X_{i1}, \ldots, X_{in}$ з часовими мітками $T_{i1}, \ldots, T_{in}$ - це $(2 \cdot d + 3)$-кортеж $(CF^{2x}, CF^{1x}, CF^2 t, CF^1 t, n)$, де $CF^{2x}$ і $CF^{1x}$ відповідають векторам з $d$ записів. Визначення кожного з цих записів є таким:

1. Для кожного виміру сума квадратів значень даних зберігається в $CF^{2x}$. Таким чином, $CF^{2x}$ містить $d$ значень. $p$-й запис $CF^{2x}$ дорівнює $\sum_{j=1}^{n} (x_p^j)^2$.

2. Для кожного виміру сума значень даних зберігається в $CF^{1x}$. Таким чином, $CF^{1x}$ містить $d$ значень. $p$-й запис $CF^{1x}$ дорівнює $\sum_{j=1}^{n} x_p^j$.

3. Сума квадратів часових міток $T_{i1}, \ldots, T_{in}$ зберігається в $CF^2 t$.

4. Сума часових міток $T_{i1}, \ldots, T_{in}$ зберігається в $CF^1 t$.

5. Кількість точок даних зберігається в $n$.

Важлива властивість мікрокластерів полягає в тому, що вони є адитивними. Іншими словами, мікрокластери можна оновлювати за допомогою чисто адитивних операцій. Зверніть увагу, що кожну з $(2 \cdot d + 3)$ компонентів мікрокластера можна виразити як лінійно роздільну суму над складовими точками даних у мікрокластері. Це важлива властивість для ефективного підтримання мікрокластерів у сценарії онлайн-потоку. Коли точка даних $X_i$ додається до мікрокластера, відповідні статистики точки даних $X_i$ потрібно додати до кожної з $(2 \cdot d + 3)$ компонентів. Аналогічно, мікрокластери для періоду потоку $(t_1, t_2)$ можна отримати, відняти мікрокластери в момент часу $t_1$ від тих, що в момент часу $t_2$. Ця властивість важлива для можливості обчислення мікрокластерів вищого рівня за довільним часовим горизонтом $(t_1, t_2)$ з мікрокластерів, збережених у різні моменти часу.

### 12.4.2.2 Алгоритм мікрокластеризації

Алгоритм кластеризації потоку даних може генерувати приблизні кластери в будь-якому заданому користувачем періоді історії від поточного моменту. Це досягається шляхом зберігання мікрокластерів у певні моменти в потоці, які називаються знімками. Водночас алгоритм завжди підтримує поточний знімок мікрокластерів. Адитивна властивість може бути використана для витягування мікрокластерів з будь-якого часового горизонту. До цього представлення застосовується фаза макрокластеризації.

Вхідними даними для алгоритму є кількість мікрокластерів, позначена як $k$. Онлайн-фаза алгоритму працює ітеративно, завжди підтримуючи поточний набір мікрокластерів. Коли надходить нова точка даних $X_i$, мікрокластери оновлюються для відображення змін. Кожна точка даних або повинна бути поглинута мікрокластером, або її потрібно помістити в окремий кластер. Перша перевага - поглинути точку даних у поточний мікрокластер. Визначається відстань точки даних до поточних центроїдів мікрокластерів $M_1, \ldots, M_k$. Значення відстані точки даних $X_i$ до центроїду мікрокластера $M_j$ позначається як $\text{dist}(M_j, X_i)$. Оскільки центроїд мікрокластера можна вивести з вектора ознак кластера, це значення відстані можна легко обчислити. Визначається найближчий центроїд $M_p$. Точка даних $X_i$ призначається своєму найближчому кластеру $M_p$, якщо тільки не буде вирішено, що точка даних "природно" не належить до цього (або будь-якого іншого) мікрокластера. У таких випадках точці даних $X_i$ потрібно призначити (новий) мікрокластер власний. Тому, перш ніж призначити точку даних мікрокластеру, спочатку потрібно вирішити, чи природно вона належить до свого найближчого центроїду мікрокластера $M_p$.