Інтуїція за цим результатом досить проста. Для рівномірно розподіленої хеш-функції, ймовірність \( R \) кінцевих нулів у бінарному представленні елемента потоку дорівнює \( 2^{-R-1} \). Отже, для \( n \) різних елементів та фіксованого значення \( R \), очікувана кількість разів, коли досягається рівно \( R \) кінцевих нулів, дорівнює \( 2^{-R-1} \cdot n \). Таким чином, для значень \( R \), більших за \( \log(n) \), очікувана кількість таких бітових рядків експоненціально зменшується до менше 1. Звичайно, в нашому застосуванні значення \( R \) не є фіксованим, а є випадковою величиною, яка генерується результатом хеш-функції. Було ретельно показано, що очікуване значення \( E[R_{\text{max}}] \) максимального значення \( R \) для всіх елементів потоку логарифмічно пов'язане з кількістю різних елементів наступним чином:

$$
E[R_{\text{max}}] = \log_2 (\phi n), \quad \phi = 0.77351.
$$

(12.30)

Стандартне відхилення становить \( \sigma (R_{\text{max}}) = 1.12 \). Отже, значення \( 2^{R_{\text{max}}} / \phi \) надає оцінку для кількості різних елементів \( n \). Для подальшого покращення оцінки \( R_{\text{max}} \) можуть бути використані наступні методи:

1. Можуть бути використані кілька хеш-функцій, і використовується середнє значення \( R_{\text{max}} \) для різних хеш-функцій.

2. Середні значення все ще дещо сприйнятливі до великих варіацій. Тому може бути використаний "трюк середнього-медіани". Повідомляються медіани набору середніх значень. Зверніть увагу, що це схоже на трюк, який використовується в скетчі AMS. Як і в тому випадку, комбінація нерівності Чебишева та границь Чернова може бути використана для встановлення якісних гарантій.

Слід зазначити, що фільтр Блума також може бути використаний для оцінки кількості різних елементів. Однак, фільтр Блума не є ефективним за використанням пам'яті способом підрахунку кількості різних елементів, коли не потрібні запити на членство в множині.

## 12.3 Видобування частих шаблонів у потоках даних

Проблема видобування частих шаблонів у потоках даних вивчається в контексті двох різних сценаріїв. Перший сценарій - це сценарій масивної області, в якому кількість можливих елементів дуже велика. У таких випадках навіть проблема знаходження частих елементів стає складною. Часті елементи також називаються важливими елементами. Другий випадок - це звичайний сценарій великої (але керованої) кількості елементів, які поміщаються в оперативну пам'ять. У таких випадках проблема частих елементів більше не є настільки цікавою, оскільки часті підрахунки можуть бути безпосередньо підтримані в масиві. У таких випадках більше цікавляться визначенням частих шаблонів. Це складна проблема, оскільки більшість алгоритмів видобування частих шаблонів вимагають кількох проходів по всьому наборі даних. Обмеження одного проходу в сценарії потоку ускладнює це. Нижче будуть описані два різні підходи. Перший з цих підходів використовує загальні структури синопсису у поєднанні з традиційними алгоритмами видобування частих шаблонів, а другий розробляє версії алгоритмів видобування частих шаблонів для потоків.

### 12.3.1 Використання структур синопсису

Структури синопсису можуть бути ефективно використані в більшості задач потокового видобування даних, включаючи видобування частих шаблонів. У контексті методів видобування частих шаблонів структури синопсису особливо привабливі завдяки можливості використовувати більш широкий спектр алгоритмів або для включення тимчасового згасання в процес видобування частих шаблонів.